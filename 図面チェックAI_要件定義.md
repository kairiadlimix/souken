# 図面チェックAI 要件定義書

## 1. プロジェクト概要

### 1.1 目的
設計事務所から提出される図面に対して、必要な記載事項が含まれているかを自動的にチェックし、創建特有の基準に基づいた指摘を行うAIシステムを開発する。

### 1.2 背景
- 設計事務所にマニュアル通りに作業してもらっているが、社内での追加チェックが必要
- 設計事務所は必要な記載をしないことが多く、結局チェック作業が発生している
- マニュアルは存在するが、それに沿った図面作成がされていない
- 創建特有のチェック項目がある（他社からみると「ここまでやるんか！」という基準）
- 施工上の問題を事前に防ぐことができる

### 1.3 現状のフロー
```
創建 → 設計事務所 → 創建（最終チェック）
```

### 1.4 期待される効果
- チェック作業の自動化による工数削減
- チェック漏れの防止
- 創建基準の標準化と徹底
- 施工上の問題の事前防止

## 2. 機能要件

### 2.1 コア機能

#### 2.1.1 図面読み込み機能
- **入力**: PDF形式の図面ファイル
- **対応形式**: 
  - CADから出力されたPDF（ベクター形式）
  - スキャンされたPDF（ラスター形式）
- **処理**: 
  - PDFの解析
  - テキスト抽出（OCR対応）
  - 図面要素の認識（線、文字、記号など）

#### 2.1.2 自動チェック機能
- **チェック項目カテゴリ**:
  1. **必須記載事項チェック**
     - 図面番号、図面名
     - 縮尺
     - 作成日、改訂日
     - 作成者、承認者
     - 特記事項欄
     
  2. **創建特有のチェック項目**
     - 外断熱仕様の記載
     - 第一種換気システムの記載
     - 釘ピッチの記載（150mm基準）
     - 創建品質基準の遵守確認
     - 隠蔽部分の施工方法記載
     - 写真記録の指示
     
  3. **施工上の問題チェック**
     - 寸法の整合性
     - 構造上の問題（梁の取り合い、配管ルートなど）
     - 設備の配置合理性
     - 法規制遵守の確認
     - 施工順序の妥当性
     
  4. **図面間の整合性チェック**
     - 平面図と立面図の整合
     - 詳細図と全体図の整合
     - 寸法の一貫性
     - 仕様の統一性

#### 2.1.3 指摘レポート生成機能
- **出力形式**: 
  - PDFレポート
  - Excel形式
  - Web画面表示
- **レポート内容**:
  - チェック結果サマリー
  - 指摘事項一覧（重要度別）
  - 指摘箇所の図面へのマーキング
  - 修正推奨事項
  - チェック通過項目

### 2.2 チェック項目管理機能

#### 2.2.1 チェック項目の定義
- チェック項目の追加・編集・削除
- 重要度の設定（必須/推奨/参考）
- カテゴリ分類
- チェックルールの定義（正規表現、数値範囲など）

#### 2.2.2 マニュアル連携
- 既存マニュアルとの連携
- マニュアル更新時の自動反映

### 2.3 学習・改善機能

#### 2.3.1 過去データの学習
- 過去のチェック結果の蓄積
- よくある不備パターンの学習
- チェック精度の向上

#### 2.3.2 フィードバック機能
- 誤検知の報告
- 新たなチェック項目の提案
- チェックルールの改善提案

## 3. 非機能要件

### 3.1 パフォーマンス
- 1枚の図面のチェック時間: 30秒以内（目標）
- 複数図面の一括チェック対応
- 同時処理可能な図面数: 10件以上

### 3.2 精度
- 必須項目の検出率: 95%以上
- 誤検知率: 5%以下（段階的に改善）

### 3.3 使いやすさ
- 直感的なUI
- チェック結果の視覚的な表示
- 修正箇所の明確な指摘

### 3.4 セキュリティ
- 図面データの適切な管理
- アクセス制御
- データの暗号化

## 4. 技術要件

### 4.1 必要な技術
- **PDF処理**: PyPDF2, pdfplumber, pdf2image
- **OCR**: Tesseract, EasyOCR, または商用OCR API
- **画像処理**: OpenCV, PIL
- **AI/ML**: 
  - 図面要素認識: YOLO, Detectron2
  - テキスト認識: OCR + NLP
  - パターン認識: 機械学習モデル
- **バックエンド**: Python (FastAPI/Django)
- **フロントエンド**: React/Vue.js または Streamlit
- **データベース**: PostgreSQL（チェック結果の保存）

### 4.2 アーキテクチャ
```
[図面PDF] 
    ↓
[PDF解析モジュール]
    ↓
[OCR/テキスト抽出]
    ↓
[図面要素認識]
    ↓
[チェックエンジン]
    ├─ 必須記載事項チェック
    ├─ 創建特有項目チェック
    ├─ 施工問題チェック
    └─ 整合性チェック
    ↓
[レポート生成]
    ↓
[結果出力]
```

## 5. 実装フェーズ

### Phase 1: プロトタイプ（MVP）
- 基本的なPDF読み込み
- テキスト抽出と必須項目チェック
- 簡単なレポート出力
- **期間**: 2-3週間

### Phase 2: 機能拡張
- OCR対応（スキャン図面）
- 創建特有項目のチェック実装
- 図面要素認識の実装
- **期間**: 4-6週間

### Phase 3: 高度な機能
- 施工上の問題チェック
- 図面間整合性チェック
- 学習機能の実装
- **期間**: 6-8週間

### Phase 4: 最適化・改善
- パフォーマンス改善
- 精度向上
- UI/UX改善
- **期間**: 継続的

## 6. チェック項目例（創建特有）

### 6.1 外断熱関連
- [ ] 外断熱仕様の明記
- [ ] 断熱材の種類・厚さの記載
- [ ] 断熱材の施工方法の記載

### 6.2 換気システム関連
- [ ] 第一種換気システムの記載
- [ ] 換気経路の明示
- [ ] 換気設備の仕様記載

### 6.3 施工基準関連
- [ ] 釘ピッチの記載（150mm基準）
- [ ] 隠蔽部分の施工方法記載
- [ ] 写真記録の指示
- [ ] 創建品質基準の遵守確認

### 6.4 その他
- [ ] 安全対策の記載
- [ ] 近隣への配慮事項
- [ ] 特殊な施工方法の明記

## 7. 次のステップ

1. **チェックリストの詳細化**
   - 既存のチェックリストPDFから項目を抽出
   - 実際の図面を分析して追加項目を特定

2. **プロトタイプ開発**
   - PDF読み込み機能
   - 基本的なテキストチェック機能
   - 簡単なレポート出力

3. **テスト・改善**
   - 実際の図面でテスト
   - フィードバック収集
   - 精度向上

